#version 120

// Per-vertex Phong lighting model

varying vec4  color;
varying vec4  fragScreenPos;
varying vec4  fragWorldPos;

uniform vec3  camPos;
uniform vec3  flashlightPos;

uniform sampler2D texture;

// The colour that we passed in through the vertex shader.
varying vec4 varyingColour;
// The normal that we passed in through the vertex shader.
varying vec3 varyingNormal;
// The vertex that we passed in through the vertex shader.
varying vec4 varyingVertex;

vec3 flashlight(void);
vec3 applyLighting(void);

void main()
{
	gl_FragColor    = texture2D(texture, gl_TexCoord[0].st);

	vec3 origColor  = gl_FragColor.rgb;
	vec3 amb        = gl_LightModel.ambient.rgb;
	vec3 finalColor = origColor * amb;

	finalColor = flashlight();

	/**
	 * Add light to the scene.
	 */
	finalColor *= applyLighting();

	gl_FragColor = vec4(finalColor, 1);
}
