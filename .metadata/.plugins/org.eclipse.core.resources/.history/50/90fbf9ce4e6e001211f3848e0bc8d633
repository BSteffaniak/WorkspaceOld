package net.foxycorndog.foxycompiler;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;

import net.foxycorndog.foxycompiler.java.JavaConverter;

public class Compiler
{
	private boolean outputJava;
	
	private File sourceFile, outputFile;
	
	private static final String arguments[];
	
	static
	{
		arguments = new String[] { "-o", "-j" };
	}
	
	public static void main(String args[])
	{
		Compiler compiler = new Compiler();
		
		compiler.parseArguments(args);
		
		System.out.println("done.");
	}
	
	public Compiler()
	{
		
	}
	
	private void parseArguments(String args[])
	{
		sourceFile = new File(args[0]);
		
		int index = 1;
		
		while (index < args.length)
		{
			for (int i = 0; i < arguments.length; i ++)
			{
				String argument = arguments[i];
				
				if (args[index].equalsIgnoreCase(argument))
				{
					if (argument.equals("-o"))
					{
						index++;
						
						outputFile = new File(args[index]);
					}
					else if (argument.equals("-j"))
					{
						outputJava = true;
					}
					
					break;
				}
			}
			
			index++;
		}
	}
	
	public void compile()
	{
		String source = getContents(sourceFile);
		
		JavaConverter.convert(source);
	}
	
	private String getContents(File file)
	{
		StringBuilder contents = new StringBuilder();
		
		try
		{
			BufferedReader reader = new BufferedReader(new FileReader(file));
			
			String line = null;
			
			while ((line = reader.readLine()) != null)
			{
				contents.append(line);
			}
		}
		catch (FileNotFoundException e)
		{
			e.printStackTrace();
		}
		catch (IOException e)
		{
			e.printStackTrace();
		}
		
		return contents.toString();
	}
}